 5  REM  BASED ON APPLE SAMPLE CSV CODE
 10 D$ =  CHR$ (4):R$ =  CHR$ (13):T$ =  CHR$ (9):SU = 0
 15  DIM A%(15,16)
 20  PRINT D$;"OPEN INPUT.TXT"
 30  PRINT D$;"READ INPUT.TXT"
 40 J = 0: GOTO 60
 50 J = J + 1
 60  GOSUB 1000
 70  GOTO 50
 990  GOTO 5000
 999  REM  READ A FIELD
 1000 I = 0: GOTO 1020
 1010 I = I + 1
 1015  ONERR  GOTO 5000
 1020  GET C$
 1030  IF C$ = T$ THEN  GOTO 2000
 1040  IF C$ = R$ THEN  GOTO 2100
 1050 A$ = A$ + C$
 1060  GOTO 1020
 2000  GOSUB 2200
 2010  GOTO 1010
 2100  GOSUB 2200
 2105  IF I > K THEN K = I
 2110  RETURN 
 2200 A%(I,J) =  VAL (A$)
 2210 A$ = ""
 2220  RETURN 
 5000  POKE 216,0
 5010  PRINT D$;"CLOSE INPUT.TXT"
 5020  FOR Y = 0 TO J
 5025 LX% = 32767:HX% =  - 32767
 5030  FOR X = 0 TO K
 5040  IF A%(X,Y) < LX% THEN LX% = A%(X,Y)
 5050  IF A%(X,Y) > HX% THEN HX% = A%(X,Y)
 5060  NEXT X
 5070 SU = SU + (HX% - LX%)
 5080  NEXT Y
 5090  PRINT SU
 5100  END 
